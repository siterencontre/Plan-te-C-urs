<!-- ... Le code HTML reste inchangé jusqu'à la fin de <script> ... -->

<script>
  let posts = [];

  function publishPost() {
    const text = document.getElementById('postText').value;
    const imageInput = document.getElementById('postImage');
    const image = imageInput.files[0];

    if (!text && !image) return alert("Écrivez un texte ou ajoutez une image.");

    const reader = new FileReader();
    reader.onload = function(e) {
      const newPost = {
        author: "Vous",
        text: text,
        image: image ? e.target.result : null,
        timestamp: new Date().toISOString(),
        likes: 0,
        comments: []
      };
      posts.unshift(newPost);
      renderPosts();
      document.getElementById('postText').value = '';
      document.getElementById('postImage').value = '';
    };

    if (image) {
      reader.readAsDataURL(image);
    } else {
      const newPost = {
        author: "Vous",
        text: text,
        image: null,
        timestamp: new Date().toISOString(),
        likes: 0,
        comments: []
      };
      posts.unshift(newPost);
      renderPosts();
      document.getElementById('postText').value = '';
    }
  }

  function likePost(index) {
    posts[index].likes++;
    renderPosts();
  }

  function commentPost(index) {
    const comment = prompt("Écrivez votre commentaire :");
    if (comment) {
      posts[index].comments.push(comment);
      renderPosts();
    }
  }

  function sharePost(index) {
    alert("Publication partagée !");
  }

  function renderPosts() {
    const container = document.getElementById('postsContainer');
    container.innerHTML = '';
    posts.forEach((post, index) => {
      const div = document.createElement('div');
      div.className = 'card post';
      div.innerHTML = `
        <div class="author">${post.author} • ${new Date(post.timestamp).toLocaleString()}</div>
        <div class="text">${post.text}</div>
        ${post.image ? `<img src="${post.image}" alt="Publication">` : ''}
        <div class="actions" style="margin-top:10px;">
          <button onclick="likePost(${index})">❤️ Like (${post.likes})</button>
          <button onclick="commentPost(${index})">💬 Commenter (${post.comments.length})</button>
          <button onclick="sharePost(${index})">🔄 Partager</button>
        </div>
        ${post.comments.length > 0 ? `
          <div class="comments" style="margin-top:10px;">
            <strong>Commentaires :</strong>
            <ul style="padding-left: 20px; margin-top: 5px;">
              ${post.comments.map(c => `<li>${c}</li>`).join('')}
            </ul>
          </div>
        ` : ''}
      `;
      container.appendChild(div);
    });
  }
</script>
